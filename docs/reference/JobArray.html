<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>JobArray class - inherits from JobInfo class — JobArray • rSubmitter</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="JobArray class - inherits from JobInfo class — JobArray" />

<meta property="og:description" content="R6 Class that enables easy submission and manipulation of SLURM job arrays." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rSubmitter</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/scratch.html">Scratch space</a>
    </li>
    <li>
      <a href="../articles/tutorial_basicUse.html">Tutorial: SLURM job management and easy parallelization from R using rSubmmiter</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>JobArray class - inherits from JobInfo class</h1>
    
    <div class="hidden name"><code>JobArray.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>R6 Class that enables easy submission and manipulation of SLURM job arrays.</p>
    
    </div>

    <pre class="usage"># x <- JobArray$new(commandList, jobName = NULL, outDir = NULL, partition = NULL, time = NULL, mem = NULL, proc = NULL, totalProc = NULL, nodes = NULL, email = NULL)
# x$submit()
# x$wait(stopIfFailed = F, verbose = T)
# x$length()
# x$cancel()
# x$getState(simplify = F)
# x$getJobNames()
# x$clean()</pre>
        
    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>R6 class</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>R6Class</code> with methods and fields for SLURM job array manipulation</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Job arrays are quickly genearated and submitted allowing for efficient creation and execution
of many shell jobs in a SLURM cluster, thus facilitating parallelization when needed. This class eliminates the cumbersome task of
manually creating SLURM arrays, in its simplest form two lines of code are sufficient for a job array submmission.
Additionally, there is an added functionallity to monitor and wait for all jobs in an array once they have been submitted.</p>
<p>All jobs in an job array share the same execution requirements.
Each element in `commandList` will be submitted as an individual jobs in the array. Elements of `commandList` should be
vectors of shell commands.</p>
<p>Submission is achived by creating and executing an sbatch script, for more details on SLURM refer
to https://slurm.schedmd.com/. For job arrays refer to https://slurm.schedmd.com/job_array.html
Concatenation is possible for most methods.</p>
    
    <h2 class="hasAnchor" id="method-description"><a class="anchor" href="#method-description"></a>Method description</h2>

    
    <ol>
<li><p>Initialize
     <br />
     <code>x &lt;- JobInfo$new(commandList, jobName = NULL, outDir = NULL, partition = NULL, time = NULL, mem = NULL, proc = NULL, totalProc = NULL, nodes = NULL, email = NULL)</code>
     <br /> Parameters:
      <ul>
<li><p>commandList : list of character vectors - Each element of the list should be a vector of shell commands. Each element of the list corresponds to a different job in the array.</p></li>
<li><p>jobName : character - Name of job, if NULL one will be generated of the form rSubmitter_job_[random_alphanumeric]. Equivalent to <code>--job-name</code> of SLURM sbatch. Most output files use it as a suffix</p></li>
<li><p>outDir : character - writeable path for the sabtch script as well as the SLRUM STDERR and STDOUT files. If NULL the current working directory will be used</p></li>
<li><p>partition : character - Partition to use. Equivalent to <code>--partition</code> of SLURM sbatch</p></li>
<li><p>time : character - Time requested for job execution, one accepted format is "HH:MM:SS". Equivalent to <code>--time</code> of SLURM sbatch</p></li>
<li><p>mem : character - Memory requested for job execution, one accepted format is "xG" or "xMB". Equivalent to <code>--mem</code> of SLURM sbatch</p></li>
<li><p>proc : integer - Number of processors requested per task. Equivalent to <code>--cpus-per-task</code> of SLURM sbatch</p></li>
<li><p>totalProc : integer - Number of tasks requested for job. Equivalent to <code>--ntasks</code> of SLURM sbatch</p></li>
<li><p>nodes : integer - Number of nodes requested for job. Equivalent to <code>--nodes</code> of SLURM sbatch</p></li>
<li><p>email : character - email address to send info when job is done. Equivalent to <code>--nodes</code> of SLURM sbatch</p></li>
</ul>
     <br /> Return: <br /> object of class <code>Job</code></p></li>
<li><p>Submit job(s)
     <br />
     <code>x$submit()</code>
     <br /> Creates a job array sbatch script to <code>outDir</code> and submits it through a system call to sbatch. The script, STDERR and STDOUT sbatch files will be written to <code>outDir</code>. In the case sbatch returns a non-zero status, it will try resubmitting up 12 times with a defined interval time(TIME_WAIT_JOB_STATUS option at ~/.rSubmitter). Each element of the array will have its individual STDERR and STDOUT files with the format <code>jobName_[1-Inf].[err|out]</code>. Important options pulled from the config file located at ~/.rSubmitter: maximum number of jobs allowed in the queue (MAX_JOBS_ALLOWED:n);  maximum length of a job array (MAX_JOB_ARRAY_LENGTH:n)
     <br /> Return: <br /> self - for method concatenation</p></li>
<li><p>Wait for job(s) to finish
     <br />
     <code>x$wait(stopIfFailed = F, verbose = T)</code>
     <br /> Time between each job state check is defined in the entry TIME_WAIT_JOB_STATUS:seconds in the config file located at ~/.rSubmitter
     <br /> Parameters:
      <ul>
<li><p>stopIfFailed : logical -  if TRUE stops when one job has failed (only useful for JobArray) it then cancels the 
                                 rest of the pending and running jobs. If FALSE and one or more Jobs failed it raises a warning for each failed job</p></li>
<li><p>verbose : logical -  if TRUE prints the job state(s) at every check</p></li>
</ul>
     <br /> Return: <br /> self - for method concatenation</p></li>
<li><p>Get length of array
     <br />
     <code>x$length()</code>
     <br /> Return: <br /> numeric - number of individual jobs in array</p></li>
<li><p>Cancel job(s)
     <br />
     <code>x$cancel()</code>
     <br /> Return: <br /> self - for method concatenation</p></li>
<li><p>Get job(s) state
     <br />
     <code>x$getState(simplify = F)</code>
     <br /> Parameters:
      <ul>
<li><p>simplify : logical - if TRUE returns a freqeuncy data.frame of job states, otherwise returns individual jobs and their associated job names, job ids, and states</p></li>
</ul>
     <br /> Return: <br /> data.frame - With SLURM states</p></li>
<li><p>Get job name(s)
     <br />
     <code>x$getJobNames()</code>
     <br /> Return: <br /> character vector - With individual job names.</p></li>
<li><p>Remove SLURM-associated files
     <br />
     <code>x$clean(script = TRUE, out = TRUE, err = TRUE)</code>
     <br /> Parameters:
      <ul>
<li><p>script : logical - if TRUE deletes sbatch submission script(s) associated to this object</p></li>
<li><p>out : logical - if TRUE deletes STDOUT file(s) from SLURM associated to this object</p></li>
<li><p>err : logical - if TRUE deletes STDERR file(s) from SLURM associated to this object</p></li>
</ul>
     <br /> Return: <br /> self - for method concatenation</p></li>
</ol>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Create and submit dummy job with random job name</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='st'>"echo hola world!"</span>)
<span class='no'>job</span>$<span class='fu'>submit</span>()

<span class='co'># Create and submit dummy job with specific job name</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='st'>"echo hola world!"</span>, <span class='kw'>jobName</span> <span class='kw'>=</span> <span class='st'>"dummy"</span>)
<span class='no'>job</span>$<span class='fu'>submit</span>()

<span class='co'># Create, submit and wait for a job to finish</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='fu'>c</span>(<span class='st'>"echo hola world!"</span>, <span class='st'>"sleep 60"</span>))
<span class='no'>job</span>$<span class='fu'>submit</span>()
<span class='no'>job</span>$<span class='fu'>wait</span>()

<span class='co'># Method concatenation</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='st'>"echo hola world!"</span>, <span class='kw'>jobName</span> <span class='kw'>=</span> <span class='st'>"dummy"</span>)
<span class='no'>job</span>$<span class='fu'>submit</span>()$<span class='fu'>wait</span>()$<span class='fu'>clean</span>()

<span class='co'># Create, submit and cancel a Job</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='fu'>c</span>(<span class='st'>"echo hola world!"</span>, <span class='st'>"sleep 60"</span>))
<span class='no'>job</span>$<span class='fu'>submit</span>()
<span class='no'>job</span>$<span class='fu'>cancel</span>()

<span class='co'># Create and submit a memory-heavy job</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='st'>"echo this is too much memory!"</span>, <span class='kw'>mem</span> <span class='kw'>=</span> <span class='st'>"16G"</span>)
<span class='no'>job</span>$<span class='fu'>submit</span>()

<span class='co'># Create and submit a requesting multiple processors</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='fu'>c</span>(<span class='st'>"echo this is multi-processing"</span>, <span class='st'>"nproc"</span>), <span class='kw'>proc</span> <span class='kw'>=</span> <span class='fl'>8</span>)
<span class='no'>job</span>$<span class='fu'>submit</span>()

<span class='co'># Many options defined</span>
<span class='no'>job</span> <span class='kw'>&lt;-</span> <span class='no'>Job</span>$<span class='fu'>new</span>(<span class='fu'>c</span>(<span class='st'>"echo this are all the options"</span>, <span class='st'>"nproc"</span>), <span class='kw'>jobName</span> <span class='kw'>=</span> <span class='st'>"dummy"</span>, <span class='kw'>outDir</span> <span class='kw'>=</span> <span class='st'>"~"</span>, <span class='kw'>partition</span> <span class='kw'>=</span> <span class='st'>"normal"</span>, <span class='kw'>time</span> <span class='kw'>=</span> <span class='st'>"4:00:00"</span>, <span class='kw'>mem</span> <span class='kw'>=</span> <span class='st'>"8G"</span>, <span class='kw'>proc</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>totalProc</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nodes</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>email</span> <span class='kw'>=</span> <span class='no'>my</span>@<span class='kw'>email.com</span>)
<span class='no'>job</span>$<span class='fu'>submit</span>()

<span class='co'># Removes script, err and output files</span>
<span class='no'>job</span>$<span class='fu'>clean</span>()
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#format">Format</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#method-description">Method description</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Pablo E. Garcia-Nieto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

